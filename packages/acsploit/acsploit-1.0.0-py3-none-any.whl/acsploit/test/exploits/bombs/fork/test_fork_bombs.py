from exploits.bombs.fork import fork_bombs
from test.exploits.dummy_output import DummyOutput


def test_file_formats():
    file_formats = ['bash', 'bat', 'c', 'cc', 'cs', 'erl', 'fasm', 'go',
                    'hs', 'html', 'java', 'js', 'lsp', 'lua', 'mdb', 'php',
                    'pl', 'py', 'r', 'rb', 'rs', 's', 'scm', 'sh', 'vbs']

    for f in file_formats:
        output = DummyOutput()
        fork_bombs.options['file_format'] = f
        fork_bombs.run(output)
        assert len(output) == 1
