(self.webpackChunk=self.webpackChunk||[]).push([["app_views_projectInstall_issueAlertOptions_tsx"],{"./app/views/projectInstall/issueAlertOptions.tsx":(e,t,s)=>{"use strict";s.d(t,{r:()=>U,Z:()=>I}),s("../node_modules/core-js/modules/es.reflect.construct.js"),s("../node_modules/core-js/modules/es.object.keys.js"),s("../node_modules/core-js/modules/es.symbol.js"),s("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("../node_modules/core-js/modules/es.array.for-each.js"),s("../node_modules/core-js/modules/web.dom-collections.for-each.js"),s("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),s("../node_modules/core-js/modules/es.object.define-properties.js"),s("../node_modules/core-js/modules/es.object.define-property.js");var n,o,r,i=s("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),a=s("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),l=s("../node_modules/@babel/runtime/helpers/esm/createClass.js"),c=s("../node_modules/@babel/runtime/helpers/esm/get.js"),u=s("../node_modules/@babel/runtime/helpers/esm/inherits.js"),d=s("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),p=s("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),m=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),h=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),f=(s("../node_modules/core-js/modules/es.array.reduce.js"),s("../node_modules/core-js/modules/es.array.map.js"),s("../node_modules/core-js/modules/es.date.to-string.js"),s("../node_modules/core-js/modules/es.object.to-string.js"),s("../node_modules/core-js/modules/es.regexp.to-string.js"),s("../node_modules/core-js/modules/es.array.filter.js"),s("../node_modules/core-js/modules/es.array.some.js"),s("../node_modules/core-js/modules/es.parse-int.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.string.includes.js"),s("../node_modules/core-js/modules/es.object.values.js"),s("../node_modules/react/index.js")),v=s("../node_modules/@sentry/minimal/esm/index.js"),j=s("../node_modules/lodash/isEqual.js"),g=s.n(j),y=s("./app/components/asyncComponent.tsx"),E=s("./app/components/forms/selectControl.tsx"),_=s("./app/components/pageHeading.tsx"),S=s("./app/locale.tsx"),b=s("./app/styles/space.tsx"),R=s("./app/utils/withOrganization.tsx"),A=s("./app/views/settings/components/forms/controls/input.tsx"),O=s("./app/views/settings/components/forms/controls/radioGroup.tsx"),Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function C(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function w(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?C(Object(s),!0).forEach((function(t){(0,m.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):C(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}!function(e){e[e.ERRORS=0]="ERRORS",e[e.USERS=1]="USERS"}(o||(o={})),function(e){e[e.ALERT_ON_EVERY_ISSUE=0]="ALERT_ON_EVERY_ISSUE",e[e.CUSTOMIZED_ALERTS=1]="CUSTOMIZED_ALERTS",e[e.CREATE_ALERT_LATER=2]="CREATE_ALERT_LATER"}(r||(r={}));var T="sentry.rules.conditions.event_frequency.EventUniqueUserFrequencyCondition",x="sentry.rules.conditions.event_frequency.EventFrequencyCondition",U="sentry.rules.conditions.event_frequency.EventFrequencyPercentCondition",P=(n={},(0,m.Z)(n,o.ERRORS,x),(0,m.Z)(n,o.USERS,T),n);function k(e,t,s){var n;switch(t){case o.ERRORS:n=x;break;case o.USERS:n=T;break;default:throw new RangeError("Supplied metric value is not handled")}return{interval:e,id:n,value:s}}var L=function(e){(0,u.Z)(m,e);var t,s,n=(t=m,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,p.Z)(t);if(s){var o=(0,p.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)});function m(){return(0,a.Z)(this,m),n.apply(this,arguments)}return(0,l.Z)(m,[{key:"getDefaultState",value:function(){return w(w({},(0,c.Z)((0,p.Z)(m.prototype),"getDefaultState",this).call(this)),{},{conditions:[],intervalChoices:[],alertSetting:r.CREATE_ALERT_LATER.toString(),metric:o.ERRORS,interval:"",threshold:""})}},{key:"getAvailableMetricChoices",value:function(){var e=this;return[[o.ERRORS,(0,S.t)("occurrences of")],[o.USERS,(0,S.t)("users affected by")]].filter((function(t){var s,n,o=(0,i.Z)(t,1)[0];return null===(s=e.state.conditions)||void 0===s||null===(n=s.some)||void 0===n?void 0:n.call(s,(function(e){return(null==e?void 0:e.id)===P[o]}))}))}},{key:"getIssueAlertsChoices",value:function(e){var t=this,s=[[r.CREATE_ALERT_LATER.toString(),(0,S.t)("I'll create my own alerts later")],[r.ALERT_ON_EVERY_ISSUE.toString(),(0,S.t)("Alert me on every new issue")]];return e&&s.push([r.CUSTOMIZED_ALERTS.toString(),(0,Z.BX)(q,{onClick:function(e){e.preventDefault();var s=r.CUSTOMIZED_ALERTS.toString();t.setStateAndUpdateParents({alertSetting:s})},children:[(0,S.t)("When there are more than"),(0,Z.tZ)(D,{type:"number",min:"0",name:"",placeholder:"10",value:this.state.threshold,onChange:function(e){return t.setStateAndUpdateParents({threshold:e.target.value})},"data-test-id":"range-input"}),(0,Z.tZ)(M,{value:this.state.metric,choices:this.getAvailableMetricChoices(),onChange:function(e){return t.setStateAndUpdateParents({metric:e.value})},"data-test-id":"metric-select-control"}),(0,S.t)("a unique error in"),(0,Z.tZ)(M,{value:this.state.interval,choices:this.state.intervalChoices,onChange:function(e){return t.setStateAndUpdateParents({interval:e.value})},"data-test-id":"interval-select-control"})]},r.CUSTOMIZED_ALERTS)]),s.map((function(e){var t=(0,i.Z)(e,2),s=t[0],n=t[1];return[s,(0,Z.tZ)(N,{children:n},s)]}))}},{key:"getUpdatedData",value:function(){var e,t;switch(parseInt(this.state.alertSetting,10)){case r.ALERT_ON_EVERY_ISSUE:e=!0,t=!1;break;case r.CREATE_ALERT_LATER:e=!1,t=!1;break;case r.CUSTOMIZED_ALERTS:e=!1,t=!0;break;default:throw new RangeError("Supplied alert creation action is not handled")}return{defaultRules:e,shouldCreateCustomRule:t,name:"Send a notification for new issues",conditions:this.state.interval.length>0&&this.state.threshold.length>0?[k(this.state.interval,this.state.metric,this.state.threshold)]:void 0,actions:[{id:"sentry.rules.actions.notify_event.NotifyEventAction"}],actionMatch:"all",frequency:5}}},{key:"setStateAndUpdateParents",value:function(e,t){var s=this;this.setState(e,(function(){null==t||t(),s.props.onChange(s.getUpdatedData())}))}},{key:"getEndpoints",value:function(){return[["conditions","/projects/".concat(this.props.organization.slug,"/rule-conditions/")]]}},{key:"onLoadAllEndpointsSuccess",value:function(){var e,t,s=this,n=null===(e=this.state.conditions)||void 0===e||null===(t=e.filter)||void 0===t?void 0:t.call(e,(function(e){return Object.values(P).includes(null==e?void 0:e.id)}));if(n&&0!==n.length){var o=function(e){var t,s=e.map((function(e){var t,s;return null===(t=e.formFields)||void 0===t||null===(s=t.interval)||void 0===s?void 0:s.choices})).reduce((function(e,t){return e&&t&&g()(e,t)?e:null}));return{intervalChoices:s,interval:null==s||null===(t=s[0])||void 0===t?void 0:t[0]}}(n),r=o.intervalChoices,i=o.interval;if(!r||!i)return v.$e((function(e){e.setExtra("props",s.props),e.setExtra("state",s.state),v.Tb(new Error("Interval choices or sent from API endpoint is inconsistent or empty"))})),void this.setStateAndUpdateParents({conditions:void 0});this.setStateAndUpdateParents({conditions:n,intervalChoices:r,interval:i})}else this.setStateAndUpdateParents({conditions:void 0})}},{key:"renderBody",value:function(){var e,t=this,s=this.getIssueAlertsChoices((null===(e=this.state.conditions)||void 0===e?void 0:e.length)>0);return(0,Z.BX)(f.Fragment,{children:[(0,Z.tZ)(F,{withMargins:!0,children:(0,S.t)("Set your default alert settings")}),(0,Z.tZ)(B,{choices:s,label:(0,S.t)("Options for creating an alert"),onChange:function(e){return t.setStateAndUpdateParents({alertSetting:e})},value:this.state.alertSetting})]})}}]),m}(y.Z);const I=(0,R.Z)(L);var q=(0,h.Z)("div",{target:"e12p23qf5"})("display:grid;grid-template-columns:repeat(5, max-content);grid-gap:",(0,b.Z)(1),";align-items:center;"),D=(0,h.Z)(A.Z,{target:"e12p23qf4"})({name:"m0jwvv",styles:"width:80px"}),M=(0,h.Z)(E.Z,{target:"e12p23qf3"})({name:"efbx4f",styles:"width:160px"}),B=(0,h.Z)(O.Z,{target:"e12p23qf2"})("padding:",(0,b.Z)(3)," 0;margin-bottom:50px;box-shadow:0 -1px 0 rgba(0, 0, 0, 0.1);"),F=(0,h.Z)(_.Z,{target:"e12p23qf1"})({name:"1ojfw6c",styles:"margin-top:65px"}),N=(0,h.Z)("div",{target:"e12p23qf0"})({name:"p9mutn",styles:"min-height:35px;display:flex;flex-direction:column;justify-content:center"})}}]);
//# sourceMappingURL=../sourcemaps/app_views_projectInstall_issueAlertOptions_tsx.46f667c7c5c4d9d6740b2f7fa93b3399.js.map